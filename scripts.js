var rawCsv = "1:1:1 Twin Princes,Faint Memory (Green),Sword Jadeite,Bow Jadeite,Earth Alcryst (Green),Ranger's Memory (Green),Warrior's Memory (Green),Praying Angel Statue (Green),Sorrowful Heart,Murky Fluid,\n" +
  "1:1:2 Premonition of Blood and Ruin,Faint Memory (Green),Greatsword Jadeite,Gun Jadeite,Ice Alcryst (Green),Knight's Memory (Green),Gunner's Memory (Green),Prowling Wyvern Statue (Green),Grey Spiritsand,Murky Fluid,\n" +
  "1:1:3 United Front,Faint Memory (Green),Katana Jadeite,Staff Jadeite,Wind Alcryst (Green),Paladin's Memory (Green),White Mage's Memory (Green),Praying Angel Statue (Green),Sorrowful Heart,Murky Fluid,\n" +
  "1:1:4 Do As the Lions Do,Faint Memory (Green),Fists Jadeite,Mace Jadeite,Fire Alcryst (Green),Soldier's Memory (Green),Black Mage's Memory (Green),Prowling Wyvern Statue (Green),Grey Spiritsand,Cloudy Sap,Longsword Crafting Recipe\n" +
  "1:1:5 Proof of Trust,Faint Memory (Green),Sword Jadeite,Spear Jadeite,Lightning Alcryst (Green),Monk's Memory (Green),Red Mage's Memory (Green),Praying Angel Statue (Green),Sorrowful Heart,Murky Fluid,Claymore Crafting Recipe\n" +
  "1:1:6 Amongst the Ruins,Faint Memory (Green),Greatsword Jadeite,Dagger Jadeite,Water Alcryst (Green),Samurai's Memory (Green),Green Mage's Memory (Green),Prowling Wyvern Statue (Green),Sorrowful Heart,Murky Fluid,Kotetsu Crafting Recipe\n" +
  "1:1:7 Show Me Strength,Faint Memory (Green),Katana Jadeite,Ninja Blade Jadeite,Light Alcryst (Green),Lancer's Memory (Green),Time Mage's Memory (Green),Praying Angel Statue (Green),Sorrowful Heart,Murky Fluid,Metal Knuckles Crafting Recipe\n" +
  "1:1:8 Ancient Relic,Faint Memory (Green),Fists Jadeite,Bow Jadeite,Dark Alcryst (Green),Dragoon's Memory (Green),Spellblade's Memory (Green),Prowling Wyvern Statue (Green),Sorrowful Heart,Cloudy Sap,Long Bow Crafting Recipe\n" +
  "1:1:9 The Way of Hourne,Faint Memory (Green),Spear Jadeite,Gun Jadeite,Earth Alcryst (Green),Thief's Memory (Green),Cleric's Memory (Green),Praying Angel Statue (Green),Grey Spiritsand,Murky Fluid,Capella Crafting Recipe\n" +
  "1:1:10 Prove Your Worth,Faint Memory (Green),Dagger Jadeite,Staff Jadeite,Ice Alcryst (Green),Ninja's Memory (Green),Winged One's Memory (Green),Warrior's Memory (Green),Prowling Wyvern Statue (Green),Grey Spiritsand,Murky Fluid,Iron Rod Crafting Recipe\n" +
  "1:2:1 To the Lion's Den,Faint Memory (Green),Ninja Blade Jadeite,Mace Jadeite,Wind Alcryst (Green),Ranger's Memory (Green),Knight's Memory (Green),Praying Angel Statue (Green),Sorrowful Heart,Cloudy Sap,Iron Mace Crafting Recipe\n" +
  "1:2:2 The Savage King's Daughter,Faint Memory (Green),Sword Jadeite,Bow Jadeite,Fire Alcryst (Green),Gunner's Memory (Green),Paladin's Memory (Green),Prowling Wyvern Statue (Green),Sorrowful Heart,Murky Fluid,Iron Plate Crafting Recipe\n" +
  "1:2:3 All the Happiness in the World,Faint Memory (Green),Greatsword Jadeite,Gun Jadeite,Lightning Alcryst (Green),Soldier's Memory (Green),White Mage's Memory (Green),Praying Angel Statue (Green),Sorrowful Heart,Cloudy Sap,Partisan Crafting Recipe\n" +
  "1:2:4 Afoul of the Gods,Faint Memory (Green),Katana Jadeite,Staff Jadeite,Water Alcryst (Green),Black Mage's Memory (Green),Monk's Memory (Green),Prowling Wyvern Statue (Green),Grey Spiritsand,Murky Fluid,Dagger Crafting Recipe\n" +
  "1:2:5 Volition,Faint Memory (Green),Fists Jadeite,Mace Jadeite,Light Alcryst (Green),Red Mage's Memory (Green),Samurai's Memory (Green),Praying Angel Statue (Green),Murky Fluid,Cloudy Sap,Iron Helm Crafting Recipe\n" +
  "1:2:6 What You Should Fear,Faint Memory (Green),Sword Jadeite,Spear Jadeite,Dark Alcryst (Green),Green Mage's Memory (Green),Lancer's Memory (Green),Prowling Wyvern Statue (Green),Grey Spiritsand,Sorrowful Heart,Hero's Ring Crafting Recipe\n" +
  "1:2:7 Wavering Spirit,Faint Memory (Green),Greatsword Jadeite,Dagger Jadeite,Earth Alcryst (Green),Time Mage's Memory (Green),Dragoon's Memory (Green),Praying Angel Statue (Green),Sorrowful Heart,Murky Fluid,Longsword Crafting Recipe\n" +
  "1:2:8 Radiant Light,Faint Memory (Green),Katana Jadeite,Ninja Blade Jadeite,Ice Alcryst (Green),Spellblade's Memory (Green),Thief's Memory (Green),Prowling Wyvern Statue (Green),Murky Fluid,Cloudy Sap,Claymore Crafting Recipe\n" +
  "1:2:9 Never-Ending Battle,Faint Memory (Green),Fists Jadeite,Bow Jadeite,Wind Alcryst (Green),Cleric's Memory (Green),Ninja's Memory (Green),Praying Angel Statue (Green),Grey Spiritsand,Sorrowful Heart,Kotetsu Crafting Recipe\n" +
  "1:2:10 Redemption,Faint Memory (Green),Spear Jadeite,Gun Jadeite,Fire Alcryst (Green),Ranger's Memory (Green),Winged One's Memory (Green),Warrior's Memory (Green),Prowling Wyvern Statue (Green),Murky Fluid,Cloudy Sap,Metal Knuckles Crafting Recipe\n" +
  "1:3:1 Concerns,Faint Memory (Blue),Sword Azurite,Bow Azurite,Lightning Alcryst (Blue),Ranger's Memory (Blue),Warrior's Memory (Blue),Praying Angel Statue (Blue),Sorrowful Heart,Murky Fluid,Partisan Crafting Recipe\n" +
  "1:3:2 Shadows in the Ruins,Faint Memory (Blue),Greatsword Azurite,Gun Azurite,Water Alcryst (Blue),Knight's Memory (Blue),Gunner's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Murky Fluid,Dagger Crafting Recipe\n" +
  "1:3:3 False Accusations,Faint Memory (Blue),Katana Azurite,Staff Azurite,Light Alcryst (Blue),Paladin's Memory (Blue),White Mage's Memory (Blue),Praying Angel Statue (Blue),Murky Fluid,Cloudy Sap,Kunai Crafting Recipe\n" +
  "1:3:4 Road to Ruin I,Faint Memory (Blue),Fists Azurite,Mace Azurite,Dark Alcryst (Blue),Soldier's Memory (Blue),Black Mage's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Murky Fluid,Long Bow Crafting Recipe\n" +
  "1:3:5 Road to Ruin II,Faint Memory (Blue),Sword Azurite,Spear Azurite,Earth Alcryst (Blue),Monk's Memory (Blue),Red Mage's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Cloudy Sap,Capella Crafting Recipe\n" +
  "1:3:6 Boisterous Stars,Faint Memory (Blue),Greatsword Azurite,Dagger Azurite,Ice Alcryst (Blue),Samurai's Memory (Blue),Green Mage's Memory (Blue),Prowling Wyvern Statue (Blue),Sorrowful Heart,Murky Fluid,Iron Rod Crafting Recipe\n" +
  "1:3:7 What Has Been Lost,Faint Memory (Blue),Katana Azurite,Ninja Blade Azurite,Wind Alcryst (Blue),Lancer's Memory (Blue),Time Mage's Memory (Blue),Praying Angel Statue (Blue),Sorrowful Heart,Murky Fluid,Iron Mace Crafting Recipe\n" +
  "1:3:8 To Keep One Person Safe,Faint Memory (Blue),Fists Azurite,Bow Azurite,Fire Alcryst (Blue),Dragoon's Memory (Blue),Spellblade's Memory (Blue),Prowling Wyvern Statue (Blue),Murky Fluid,Cloudy Sap,Iron Plate Crafting Recipe\n" +
  "1:3:10 Reinforcements,Faint Memory (Blue),Spear Azurite,Gun Azurite,Lightning Alcryst (Blue),Thief's Memory (Blue),Cleric's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Sorrowful Heart,Wizard's Hat Crafting Recipe\n" +
  "2:1:1 <<Fortem>> Move Out I,Faint Memory (Blue),Dagger Azurite,Staff Azurite,Water Alcryst (Blue),Ninja's Memory (Blue),Winged One's Memory (Blue),Warrior's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Sorrowful Heart,Scholar Robe Crafting Recipe\n" +
  "2:1:2 <<Fortem>> Move Out II,Faint Memory (Blue),Sword Azurite,Ninja Blade Azurite,Light Alcryst (Blue),Knight's Memory (Blue),Gunner's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Murky Fluid,Iron Helm Crafting Recipe\n" +
  "2:1:3 What It Takes to Be a Prince,Faint Memory (Blue),Greatsword Azurite,Bow Azurite,Dark Alcryst (Blue),Paladin's Memory (Blue),White Mage's Memory (Blue),Praying Angel Statue (Blue),Sorrowful Heart,Cloudy Sap,Hero's Ring Crafting Recipe\n" +
  "2:1:4 The Successor,Faint Memory (Blue),Katana Azurite,Gun Azurite,Earth Alcryst (Blue),Soldier's Memory (Blue),Black Mage's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Cloudy Sap,Longsword Crafting Recipe\n" +
  "2:1:5 Bloom I,Faint Memory (Blue),Fists Azurite,Staff Azurite,Ice Alcryst (Blue),Monk's Memory (Blue),Red Mage's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Sorrowful Heart,Claymore Crafting Recipe\n" +
  "2:1:6 Bloom II,Faint Memory (Blue),Spear Azurite,Mace Azurite,Wind Alcryst (Blue),Samurai's Memory (Blue),Green Mage's Memory (Blue),Prowling Wyvern Statue (Blue),Sorrowful Heart,Murky Fluid,Kotetsu Crafting Recipe\n" +
  "2:1:7 Continuing Attack,Faint Memory (Blue),Sword Azurite,Dagger Azurite,Fire Alcryst (Blue),Lancer's Memory (Blue),Time Mage's Memory (Blue),Praying Angel Statue (Blue),Sorrowful Heart,Murky Fluid,Metal Knuckles Crafting Recipe\n" +
  "2:1:8 You Should As Well,Faint Memory (Blue),Greatsword Azurite,Ninja Blade Azurite,Lightning Alcryst (Blue),Dragoon's Memory (Blue),Spellblade's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Cloudy Sap,Partisan Crafting Recipe\n" +
  "2:1:9 <<Fortem>> Has Arrived,Faint Memory (Blue),Katana Azurite,Bow Azurite,Water Alcryst (Blue),Thief's Memory (Blue),Cleric's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Murky Fluid,Dagger Crafting Recipe\n" +
  "2:1:10 What the Stars Say,Faint Memory (Blue),Fists Azurite,Gun Azurite,Light Alcryst (Blue),Ninja's Memory (Blue),Winged One's Memory (Blue),Warrior's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Murky Fluid,Kunai Crafting Recipe\n" +
  "2:2:1 A Fighting Retreat I,Faint Memory (Blue),Spear Azurite,Staff Azurite,Dark Alcryst (Blue),Ranger's Memory (Blue),Knight's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Sorrowful Heart,Long Bow Crafting Recipe\n" +
  "2:2:2 Message,Faint Memory (Blue),Dagger Azurite,Mace Azurite,Earth Alcryst (Blue),Ranger's Memory (Blue),Gunner's Memory (Blue),Prowling Wyvern Statue (Blue),Murky Fluid,Cloudy Sap,Capella Crafting Recipe\n" +
  "2:2:3 A Fighting Retreat II,Faint Memory (Blue),Sword Azurite,Ninja Blade Azurite,Ice Alcryst (Blue),Paladin's Memory (Blue),White Mage's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Cloudy Sap,Iron Rod Crafting Recipe\n" +
  "2:2:4 I Would Shed a Tear,Faint Memory (Blue),Greatsword Azurite,Bow Azurite,Wind Alcryst (Blue),Soldier's Memory (Blue),Black Mage's Memory (Blue),Prowling Wyvern Statue (Blue),Grey Spiritsand,Murky Fluid,Iron Mace Crafting Recipe\n" +
  "2:2:5 Duty As a Guardian,Faint Memory (Blue),Katana Azurite,Gun Azurite,Fire Alcryst (Blue),Monk's Memory (Blue),Red Mage's Memory (Blue),Praying Angel Statue (Blue),Sorrowful Heart,Cloudy Sap,Iron Plate Crafting Recipe\n" +
  "2:2:6 Silent Lion's Den,Faint Memory (Blue),Fists Azurite,Staff Azurite,Lightning Alcryst (Blue),Samurai's Memory (Blue),Green Mage's Memory (Blue),Prowling Wyvern Statue (Blue),Sorrowful Heart,Cloudy Sap,Wizard's Hat Crafting Recipe\n" +
  "2:2:7 Two Shinobi,Faint Memory (Blue),Spear Azurite,Mace Azurite,Water Alcryst (Blue),Lancer's Memory (Blue),Time Mage's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Murky Fluid,Scholar Robe Crafting Recipe\n" +
  "2:2:8 The Royal Bloodline,Faint Memory (Blue),Sword Azurite,Dagger Azurite,Light Alcryst (Blue),Dragoon's Memory (Blue),Spellblade's Memory (Blue),Prowling Wyvern Statue (Blue),Murky Fluid,Cloudy Sap,Iron Helm Crafting Recipe\n" +
  "2:2:9 Return of the Prince,Faint Memory (Blue),Greatsword Azurite,Ninja Blade Azurite,Dark Alcryst (Blue),Thief's Memory (Blue),Cleric's Memory (Blue),Praying Angel Statue (Blue),Grey Spiritsand,Sorrowful Heart,Hero's Ring Crafting Recipe\n" +
  "2:2:10 Pride of the Lions,Faint Memory (Blue),Katana Azurite,Bow Azurite,Earth Alcryst (Blue),Ninja's Memory (Blue),Winged One's Memory (Blue),Warrior's Memory (Blue),Prowling Wyvern Statue (Blue),Murky Fluid,Cloudy Sap,Longsword Crafting Recipe\n" +
  "2:3:1 Godess's Revelation,Faint Memory (Purple),Sword Charoite,Fists Charoite,Ice Alcryst (Purple),Ranger's Memory (Purple),Knight's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Sorrowful Heart,Claymore Crafting Recipe\n" +
  "2:3:2 Before I Forget  You,Faint Memory (Purple),Greatsword Charoite,Spear Charoite,Wind Alcryst (Purple),Gunner's Memory (Purple),Paladin's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Kotetsu Crafting Recipe\n" +
  "2:3:3 For the Sake of the Bloodline,Faint Memory (Purple),Katana Charoite,Dagger Charoite,Fire Alcryst (Purple),Soldier's Memory (Purple),White Mage's Memory (Purple),Praying Angel Statue (Purple),Sorrowful Heart,Cloudy Sap,Metal Knuckles Crafting Recipe\n" +
  "2:3:4 Master's Spirit,Faint Memory (Purple),Fists Charoite,Ninja Blade Charoite,Lightning Alcryst (Purple),Black Mage's Memory (Purple),Monk's Memory (Purple),Prowling Wyvern Statue (Purple),Grey Spiritsand,Cloudy Sap,Partisan Crafting Recipe\n" +
  "2:3:5 Return the Favor,Faint Memory (Purple),Spear Charoite,Bow Charoite,Water Alcryst (Purple),Red Mage's Memory (Purple),Samurai's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Murky Fluid,Dagger Crafting Recipe\n" +
  "2:3:6 On the Run,Faint Memory (Purple),Dagger Charoite,Gun Charoite,Light Alcryst (Purple),Green Mage's Memory (Purple),Lancer's Memory (Purple),Prowling Wyvern Statue (Purple),Sorrowful Heart,Murky Fluid,Kunai Crafting Recipe\n" +
  "2:3:7 The Bull and the Viper,Faint Memory (Purple),Staff Charoite,Ninja Blade Charoite,Dark Alcryst (Purple),Time Mage's Memory (Purple),Dragoon's Memory (Purple),Praying Angel Statue (Purple),Sorrowful Heart,Murky Fluid,Long Bow Crafting Recipe\n" +
  "2:3:8 Threat to the West,Faint Memory (Purple),Bow Charoite,Mace Charoite,Earth Alcryst (Purple),Spellblade's Memory (Purple),Thief's Memory (Purple),Prowling Wyvern Statue (Purple),Grey Spiritsand,Cloudy Sap,Capella Crafting Recipe\n" +
  "2:3:9 Enclosing Plots,Faint Memory (Purple),Sword Charoite,Gun Charoite,Ice Alcryst (Purple),Cleric's Memory (Purple),Ninja's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Murky Fluid,Iron Rod Crafting Recipe\n" +
  "2:3:10 First Sword,Faint Memory (Purple),Greatsword Charoite,Staff Charoite,Wind Alcryst (Purple),Ranger's Memory (Purple),Monk's Memory (Purple),Winged One's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Iron Mace Crafting Recipe\n" +
  "3:1:1 Creeping Despair,Faint Memory (Purple),Katana Charoite,Mace Charoite,Fire Alcryst (Purple),Gunner's Memory (Purple),Warrior's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Sorrowful Heart,Iron Plate Crafting Recipe\n" +
  "3:1:2 Withering Hope,Faint Memory (Purple),Sword Charoite,Fists Charoite,Lightning Alcryst (Purple),Knight's Memory (Purple),White Mage's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Wizard's Hat Crafting Recipe\n" +
  "3:1:3 The Church's Aim I,Faint Memory (Purple),Greatsword Charoite,Spear Charoite,Water Alcryst (Purple),Paladin's Memory (Purple),Black Mage's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Cloudy Sap,Scholar Robe Crafting Recipe\n" +
  "3:1:4 The Church's Aim II,Faint Memory (Purple),Katana Charoite,Dagger Charoite,Light Alcryst (Purple),Soldier's Memory (Purple),Red Mage's Memory (Purple),Prowling Wyvern Statue (Purple),Grey Spiritsand,Murky Fluid,Iron Helm Crafting Recipe\n" +
  "3:1:5 The True State of Wezette I,Faint Memory (Purple),Fists Charoite,Ninja Blade Charoite,Dark Alcryst (Purple),Monk's Memory (Purple),Green Mage's Memory (Purple),Praying Angel Statue (Purple),Sorrowful Heart,Murky Fluid,Hero's Ring Crafting Recipe\n" +
  "3:1:6 The True State of Wezette II,Faint Memory (Purple),Spear Charoite,Bow Charoite,Earth Alcryst (Purple),Samurai's Memory (Purple),Time Mage's Memory (Purple),Prowling Wyvern Statue (Purple),Sorrowful Heart,Cloudy Sap,Longsword Crafting Recipe\n" +
  "3:1:7 Remote Village,Faint Memory (Purple),Dagger Charoite,Gun Charoite,Ice Alcryst (Purple),Lancer's Memory (Purple),Spellblade's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Murky Fluid,Claymore Crafting Recipe\n" +
  "3:1:8 Defiance,Faint Memory (Purple),Staff Charoite,Ninja Blade Charoite,Wind Alcryst (Purple),Dragoon's Memory (Purple),Cleric's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Kotetsu Crafting Recipe\n" +
  "3:1:9 Rebellion and Suppression,Faint Memory (Purple),Bow Charoite,Mace Charoite,Fire Alcryst (Purple),Thief's Memory (Purple),Warrior's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Sorrowful Heart,Metal Knuckles Crafting Recipe\n" +
  "3:1:10 Pay with Your Life,Faint Memory (Purple),Sword Charoite,Gun Charoite,Lightning Alcryst (Purple),Knight's Memory (Purple),Ninja's Memory (Purple),Winged One's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Partisan Crafting Recipe\n" +
  "3:2:1 Mastermind,Faint Memory (Purple),Greatsword Charoite,Staff Charoite,Water Alcryst (Purple),Ranger's Memory (Purple),Paladin's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Sorrowful Heart,Dagger Crafting Recipe\n" +
  "3:2:2 Allow Me,Faint Memory (Purple),Katana Charoite,Mace Charoite,Light Alcryst (Purple),Gunner's Memory (Purple),Soldier's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Kunai Crafting Recipe\n" +
  "3:2:3 No Need for Mercy I,Faint Memory (Purple),Sword Charoite,Fists Charoite,Dark Alcryst (Purple),White Mage's Memory (Purple),Monk's Memory (Purple),Praying Angel Statue (Purple),Sorrowful Heart,Cloudy Sap,Long Bow Crafting Recipe\n" +
  "3:2:4 No Need for Mercy II,Faint Memory (Purple),Greatsword Charoite,Spear Charoite,Earth Alcryst (Purple),Black Mage's Memory (Purple),Samurai's Memory (Purple),Prowling Wyvern Statue (Purple),Grey Spiritsand,Cloudy Sap,Capella Crafting Recipe\n" +
  "3:2:5 Minwu the Villager,Faint Memory (Purple),Katana Charoite,Dagger Charoite,Ice Alcryst (Purple),Red Mage's Memory (Purple),Lancer's Memory (Purple),Praying Angel Statue (Purple),Sorrowful Heart,Murky Fluid,Iron Rod Crafting Recipe\n" +
  "3:2:6 Keep the Coin,Faint Memory (Purple),Fists Charoite,Ninja Blade Charoite,Wind Alcryst (Purple),Green Mage's Memory (Purple),Dragoon's Memory (Purple),Prowling Wyvern Statue (Purple),Sorrowful Heart,Murky Fluid,Iron Mace Crafting Recipe\n" +
  "3:2:7 Leave the Village,Faint Memory (Purple),Spear Charoite,Bow Charoite,Fire Alcryst (Purple),Time Mage's Memory (Purple),Thief's Memory (Purple),Praying Angel Statue (Purple),Sorrowful Heart,Murky Fluid,Iron Plate Crafting Recipe\n" +
  "3:2:8 A Gift,Faint Memory (Purple),Dagger Charoite,Gun Charoite,Lightning Alcryst (Purple),Spellblade's Memory (Purple),Ninja's Memory (Purple),Prowling Wyvern Statue (Purple),Grey Spiritsand,Cloudy Sap,Wizard's Hat Crafting Recipe\n" +
  "3:2:9 Radiance of Destruction,Faint Memory (Purple),Staff Charoite,Ninja Blade Charoite,Water Alcryst (Purple),Ranger's Memory (Purple),Cleric's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Sorrowful Heart,Scholar Robe Crafting Recipe\n" +
  "3:2:10 Uncertainty,Faint Memory (Purple),Bow Charoite,Mace Charoite,Light Alcryst (Purple),Gunner's Memory (Purple),Dragoon's Memory (Purple),Winged One's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Iron Helm Crafting Recipe\n" +
  "3:3:1 <<Nitor>> Move Out,Faint Memory (Purple),Sword Charoite,Gun Charoite,Dark Alcryst (Purple),White Mage's Memory (Purple),Warrior's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Sorrowful Heart,Hero's Ring Crafting Recipe\n" +
  "3:3:2 True Intentions,Faint Memory (Purple),Greatsword Charoite,Staff Charoite,Earth Alcryst (Purple),Knight's Memory (Purple),Black Mage's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Longsword Crafting Recipe\n" +
  "3:3:3 Growing Mistrust,Faint Memory (Purple),Katana Charoite,Mace Charoite,Ice Alcryst (Purple),Paladin's Memory (Purple),Red Mage's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Cloudy Sap,Claymore Crafting Recipe\n" +
  "3:3:4 Road to Wezette,Faint Memory (Purple),Sword Charoite,Fists Charoite,Wind Alcryst (Purple),Soldier's Memory (Purple),Green Mage's Memory (Purple),Prowling Wyvern Statue (Purple),Grey Spiritsand,Murky Fluid,Kotetsu Crafting Recipe\n" +
  "3:3:5 Muraga's Prey,Faint Memory (Purple),Greatsword Charoite,Spear Charoite,Earth Alcryst (Purple),Monk's Memory (Purple),Time Mage's Memory (Purple),Praying Angel Statue (Purple),Sorrowful Heart,Murky Fluid,Metal Knuckles Crafting Recipe\n" +
  "3:3:6 Reckless Brothers I,Faint Memory (Purple),Katana Charoite,Dagger Charoite,Lightning Alcryst (Purple),Samurai's Memory (Purple),Spellblade's Memory (Purple),Prowling Wyvern Statue (Purple),Sorrowful Heart,Cloudy Sap,Partisan Crafting Recipe\n" +
  "3:3:7 Reckless Brothers II,Faint Memory (Purple),Fists Charoite,Ninja Blade Charoite,Water Alcryst (Purple),Lancer's Memory (Purple),Cleric's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Murky Fluid,Dagger Crafting Recipe\n" +
  "3:3:8 Unforgettable,Faint Memory (Purple),Spear Charoite,Bow Charoite,Light Alcryst (Purple),Dragoon's Memory (Purple),Warrior's Memory (Purple),Prowling Wyvern Statue (Purple),Murky Fluid,Cloudy Sap,Kunai Crafting Recipe\n" +
  "3:3:9 Reasons,Faint Memory (Purple),Dagger Charoite,Gun Charoite,Dark Alcryst (Purple),Knight's Memory (Purple),Thief's Memory (Purple),Praying Angel Statue (Purple),Grey Spiritsand,Sorrowful Heart,Long Bow Crafting Recipe\n" +
  "3:3:10 The Queen's Plan,Faint Memory (Purple),Staff Charoite,Ninja Blade Charoite,Ice Alcryst (Purple),Paladin's Memory (Purple),Ninja's Memory (Purple),Winged One's Memory (Purple),Prowling Wyvern Statue (Purple),Sorrowful Heart,Cloudy Sap,Capella Crafting Recipe\n" +
  "4:1:1 Premonition,Faint Memory (Purple),Bow Charoite,Mace Charoite,Fire Alcryst (Purple),Ranger's Memory (Purple),Soldier's Memory (Purple),Praying Angel Statue (Purple),Blue Spiritsand,Raging Heart,Mythril Sword Crafting Recipe\n" +
  "4:1:2 Swelling Doubts,Faint Memory (Purple),Sword Charoite,Gun Charoite,Wind Alcryst (Purple),Gunner's Memory (Purple),Monk's Memory (Purple),Prowling Wyvern Statue (Purple),Sticky Fluid,Clear Sap,Mythril Saber Crafting Recipe\n" +
  "4:1:3 Abandon the Cave,Faint Memory (Purple),Greatsword Charoite,Staff Charoite,Water Alcryst (Purple),White Mage's Memory (Purple),Samurai's Memory (Purple),Praying Angel Statue (Purple),Blue Spiritsand,Clear Sap,Kiku-ichimonji Crafting Recipe\n" +
  "4:1:4 To Anvil Castle I,Faint Memory (Purple),Katana Charoite,Mace Charoite,Lightning Alcryst (Purple),Black Mage's Memory (Purple),Lancer's Memory (Purple),Prowling Wyvern Statue (Purple),Blue Spiritsand,Sticky Fluid,Mythril Claws Crafting Recipe\n" +
  "4:1:5 To Anvil Castle II,Faint Memory (Purple),Sword Charoite,Fists Charoite,Fire Alcryst (Purple),Red Mage's Memory (Purple),Dragoon's Memory (Purple),Praying Angel Statue (Purple),Raging Heart,Sticky Fluid,Mythril Spear Crafting Recipe\n" +
  "4:1:6 Perilous Road I,Faint Memory (Purple),Greatsword Charoite,Spear Charoite,Light Alcryst (Purple),Green Mage's Memory (Purple),Thief's Memory (Purple),Prowling Wyvern Statue (Purple),Raging Heart,Clear Sap,Mythril Dagger Crafting Recipe\n" +
  "4:1:7 Perilous Road II,Faint Memory (Purple),Katana Charoite,Dagger Charoite,Dark Alcryst (Purple),Time Mage's Memory (Purple),Ninja's Memory (Purple),Praying Angel Statue (Purple),Blue Spiritsand,Sticky Fluid,Kodachi Crafting Recipe\n" +
  "4:1:8 For Leonis!,Faint Memory (Purple),Fists Charoite,Ninja Blade Charoite,Earth Alcryst (Purple),Ranger's Memory (Purple),Spellblade's Memory (Purple),Prowling Wyvern Statue (Purple),Sticky Fluid,Clear Sap,Great Bow Crafting Recipe\n" +
  "4:1:9 A Peculiar Sign,Faint Memory (Purple),Spear Charoite,Bow Charoite,Ice Alcryst (Purple),Gunner's Memory (Purple),Cleric's Memory (Purple),Praying Angel Statue (Purple),Blue Spiritsand,Raging Heart,Vega Crafting Recipe\n" +
  "4:1:10 Four Stone Chests,Faint Memory (Purple),Dagger Charoite,Gun Charoite,Fire Alcryst (Purple),White Mage's Memory (Purple),Samurai's Memory (Purple),Winged One's Memory (Purple),Prowling Wyvern Statue (Purple),Raging Heart,Clear Sap,Platinum Rod Crafting Recipe\n" +
  "4:2:1 Shinobi of Fennes,Faint Memory (Purple),Staff Charoite,Ninja Blade Charoite,Water Alcryst (Purple),Black Mage's Memory (Purple),Warrior's Memory (Purple),Praying Angel Statue (Purple),Blue Spiritsand,Raging Heart,Mythril Mace Crafting Recipe\n" +
  "4:2:2 Mere Sham,Faint Memory (Purple),Bow Charoite,Mace Charoite,Dark Alcryst (Purple),Knight's Memory (Purple),Red Mage's Memory (Purple),Prowling Wyvern Statue (Purple),Sticky Fluid,Clear Sap,Mythril Armor Crafting Recipe\n" +
  "4:2:3 Break Through I,Faint Memory (Purple),Sword Charoite,Gun Charoite,Wind Alcryst (Purple),Paladin's Memory (Purple),Green Mage's Memory (Purple),Praying Angel Statue (Purple),Raging Heart,Clear Sap,Circlet Crafting Recipe\n" +
  "4:2:4 Break Through II,Faint Memory (Purple),Greatsword Charoite,Staff Charoite,Light Alcryst (Purple),Soldier's Memory (Purple),Time Mage's Memory (Purple),Prowling Wyvern Statue (Purple),Blue Spiritsand,Clear Sap,Mirage Vest Crafting Recipe\n" +
  "4:2:5 Sir Owe I,Faint Memory (Purple),Katana Charoite,Mace Charoite,Lightning Alcryst (Purple),Monk's Memory (Purple),Spellblade's Memory (Purple),Praying Angel Statue (Purple),Blue Spiritsand,Sticky Fluid,Mythril Helm Crafting Recipe\n" +
  "4:2:6 Sir Owe II,Faint Memory (Purple),Sword Charoite,Fists Charoite,Earth Alcryst (Purple),Samurai's Memory (Purple),Cleric's Memory (Purple),Prowling Wyvern Statue (Purple),Raging Heart,Sticky Fluid,Fairy Ring Crafting Recipe\n" +
  "4:2:7 A Dance of Blades and Blood,Faint Memory (Purple),Greatsword Charoite,Spear Charoite,Ice Alcryst (Purple),Lancer's Memory (Purple),Warrior's Memory (Purple),Praying Angel Statue (Purple),Raging Heart,Sticky Fluid,Mythril Sword Crafting Recipe\n" +
  "4:2:8 Scumbags Pay Their Respects,Faint Memory (Purple),Katana Charoite,Dagger Charoite,Wind Alcryst (Purple),Knight's Memory (Purple),Dragoon's Memory (Purple),Prowling Wyvern Statue (Purple),Blue Spiritsand,Clear Sap,Mythril Saber Crafting Recipe\n" +
  "4:2:9 Good Idea,Faint Memory (Purple),Fists Charoite,Ninja Blade Charoite,Fire Alcryst (Purple),Paladin's Memory (Purple),Thief's Memory (Purple),Praying Angel Statue (Purple),Blue Spiritsand,Raging Heart,Kiku-ichimonji Crafting Recipe\n" +
  "4:2:10 Enough to Kill,Faint Memory (Purple),Spear Charoite,Bow Charoite,Lightning Alcryst (Purple),Ninja's Memory (Purple),Winged One's Memory (Purple),Warrior's Memory (Purple),Prowling Wyvern Statue (Purple),Blue Spiritsand,Sticky Fluid,Mythril Claws Crafting Recipe\n" +
  "4:3:1 Dawn at Hand,Faint Memory (Yellow),Sword Citrine,Spear Citrine,Water Alcryst (Yellow),Ranger's Memory (Yellow),Knight's Memory (Yellow),Praying Angel Statue (Yellow),Raging Heart,Sticky Fluid,Mythril Spear Crafting Recipe\n" +
  "4:3:2 At Wit's End,Faint Memory (Yellow),Greatsword Citrine,Dagger Citrine,Light Alcryst (Yellow),Gunner's Memory (Yellow),Paladin's Memory (Yellow),Prowling Wyvern Statue (Yellow),Sticky Fluid,Clear Sap,Mythril Dagger Crafting Recipe\n" +
  "4:3:3 Two Paths,Faint Memory (Yellow),Katana Citrine,Ninja Blade Citrine,Dark Alcryst (Yellow),Soldier's Memory (Yellow),White Mage's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Clear Sap,Kodachi Crafting Recipe\n" +
  "4:3:4 Three Stone Chests,Faint Memory (Yellow),Fists Citrine,Bow Citrine,Earth Alcryst (Yellow),Black Mage's Memory (Yellow),Monk's Memory (Yellow),Prowling Wyvern Statue (Yellow),Blue Spiritsand,Sticky Fluid,Great Bow Crafting Recipe\n" +
  "4:3:5 Survive! I,Faint Memory (Yellow),Spear Citrine,Gun Citrine,Wind Alcryst (Yellow),Red Mage's Memory (Yellow),Samurai's Memory (Yellow),Praying Angel Statue (Yellow),Raging Heart,Sticky Fluid,Vega Crafting Recipe\n" +
  "4:3:6 Head North,Faint Memory (Yellow),Dagger Citrine,Staff Citrine,Ice Alcryst (Yellow),Green Mage's Memory (Yellow),Lancer's Memory (Yellow),Prowling Wyvern Statue (Yellow),Raging Heart,Clear Sap,Platinum Rod Crafting Recipe\n" +
  "4:3:7 Survive! II,Faint Memory (Yellow),Ninja Blade Citrine,Mace Citrine,Fire Alcryst (Yellow),Time Mage's Memory (Yellow),Dragoon's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Sticky Fluid,Mythril Mace Crafting Recipe\n" +
  "4:3:8 The Hourne Castle,Faint Memory (Yellow),Sword Citrine,Bow Citrine,Lightning Alcryst (Yellow),Spellblade's Memory (Yellow),Thief's Memory (Yellow),Prowling Wyvern Statue (Yellow),Sticky Fluid,Clear Sap,Mythril Armor Crafting Recipe\n" +
  "4:3:9 Crossing Shadows,Faint Memory (Yellow),Greatsword Citrine,Gun Citrine,Water Alcryst (Yellow),Cleric's Memory (Yellow),Ninja's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Raging Heart,Circlet Crafting Recipe\n" +
  "4:3:10 Survive! III,Faint Memory (Yellow),Dagger Citrine,Staff Citrine,Dark Alcryst (Yellow),Ranger's Memory (Yellow),Winged One's Memory (Yellow),Warrior's Memory (Yellow),Prowling Wyvern Statue (Yellow),Raging Heart,Clear Sap,Mirage Vest Crafting Recipe\n" +
  "5:1:1 The Meaning of Strength,Faint Memory (Yellow),Fists Citrine,Mace Citrine,Light Alcryst (Yellow),Ranger's Memory (Yellow),Knight's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Raging Heart,Mythril Helm Crafting Recipe\n" +
  "5:1:2 The Time Has Come,Faint Memory (Yellow),Sword Citrine,Spear Citrine,Dark Alcryst (Yellow),Gunner's Memory (Yellow),Paladin's Memory (Yellow),Prowling Wyvern Statue (Yellow),Sticky Fluid,Clear Sap,Fairy Ring Crafting Recipe\n" +
  "5:1:3 Assassination Squad,Faint Memory (Yellow),Greatsword Citrine,Dagger Citrine,Earth Alcryst (Yellow),Soldier's Memory (Yellow),White Mage's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Raging Heart,Mythril Sword Crafting Recipe\n" +
  "5:1:4 Conviction,Faint Memory (Yellow),Katana Citrine,Ninja Blade Citrine,Ice Alcryst (Yellow),Black Mage's Memory (Yellow),Monk's Memory (Yellow),Prowling Wyvern Statue (Yellow),Sticky Fluid,Clear Sap,Mythril Saber Crafting Recipe\n" +
  "5:1:5 Northward Bound,Faint Memory (Yellow),Fists Citrine,Bow Citrine,Wind Alcryst (Yellow),Red Mage's Memory (Yellow),Samurai's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Raging Heart,Kiku-ichimonji Crafting Recipe\n" +
  "5:1:6 Spark of the Dragon,Faint Memory (Yellow),Spear Citrine,Gun Citrine,Fire Alcryst (Yellow),Green Mage's Memory (Yellow),Lancer's Memory (Yellow),Prowling Wyvern Statue (Yellow),Sticky Fluid,Clear Sap,Mythril Claws Crafting Recipe\n" +
  "5:1:7 First Things First,Faint Memory (Yellow),Dagger Citrine,Staff Citrine,Lightning Alcryst (Yellow),Time Mage's Memory (Yellow),Dragoon's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Raging Heart,Mythril Spear Crafting Recipe\n" +
  "5:1:8 The Wounded Lion I,Faint Memory (Yellow),Ninja Blade Citrine,Mace Citrine,Water Alcryst (Yellow),Spellblade's Memory (Yellow),Thief's Memory (Yellow),Prowling Wyvern Statue (Yellow),Sticky Fluid,Clear Sap,Mythril Dagger Crafting Recipe\n" +
  "5:1:9 Vengeance,Faint Memory (Yellow),Sword Citrine,Bow Citrine,Light Alcryst (Yellow),Cleric's Memory (Yellow),Ninja's Memory (Yellow),Praying Angel Statue (Yellow),Blue Spiritsand,Raging Heart,Kodachi Crafting Recipe\n" +
  "5:1:10 The Wounded Lion II,Faint Memory (Yellow),Greatsword Citrine,Gun Citrine,Dark Alcryst (Yellow),Ranger's Memory (Yellow),Winged One's Memory (Yellow),Warrior's Memory (Yellow),Prowling Wyvern Statue (Yellow),Sticky Fluid,Clear Sap,Great Bow Crafting Recipe";

var stories = {};
var uniqueMaterials = [];
rawCsv = rawCsv.split("\n");
rawCsv.forEach(function (value) {
  var storyMaterials = value.split(',');
  var storyName = storyMaterials.shift();
  stories[storyName] = storyMaterials;

  storyMaterials.forEach(function (storyMaterial) {
    if (!storyMaterial) {
      return;
    }

    if (!uniqueMaterials.includes(storyMaterial)) {
      uniqueMaterials.push(storyMaterial);
    }
  });
});

uniqueMaterials.sort();


(function ($) {

  uniqueMaterials.forEach(function (material) {
    var option = '<option value="' + material + '">' + material + '</option>';
    $('#materials').append(option);
  });

  var selectEl = document.querySelector('#materials');
  accessibleAutocomplete.enhanceSelectElement({
    autoselect: true,
    confirmOnBlur: false,
    displayMenu: 'overlay',
    defaultValue: "",
    minLength: 3,
    selectElement: selectEl
    //,onConfirm: addMaterial
  });

  var materialsList = [];
  var matchedStories = {};

  /**
   * Add material to array and DOM.
   */
  function addMaterial() {
    var material = $('#materials').val();
    $('#materials').val('');

    if (!material) {
      return;
    }

    if (!materialsList.includes(material)) {
      materialsList.push(material);
    }

    // Add DOM element to list.
    var materialItem = '<div class="input-group col-md-4" data-material="' + material + '"><div class="input-group-prepend"><span class="input-group-text btn btn-close">✕</span></div><div class="form-control">' + material + '</div></div>'
    $('.materials-list').append(materialItem);
  }

  /**
   * Delete material from array and DOM.
   */
  function deleteMaterial() {
    var $parent = $(this).parents('.input-group').first();
    var material = $parent.data('material');
    $parent.remove();
    materialsList.splice(materialsList.findIndex(a => a === material), 1);
  }

  /**
   * Take the list of materials and figure out which story quests match.
   */
  function calculate() {
    if (!materialsList.length) {
      $('.feedback').html('<div class="alert alert-danger" role="alert">Add materials first.</div>');
      return;
    }

    $('.feedback').html('');

    matchedStories = {};

    for (let [storyName, storyMaterials] of Object.entries(stories)) {
      let matchedMaterials = storyMaterials.filter(x => materialsList.includes(x));
      if (!matchedMaterials.length) {
        continue;
      }

      matchedStories[storyName] = matchedMaterials;
    }

    var sortedMatchedStories = Object.keys(matchedStories)
      .map(function (k) {
        return {key: k, value: matchedStories[k]};
      })
      .sort(function (a, b) {
        return b.value.length - a.value.length;
      });

    $('.story-quest-list tbody').html('');
    sortedMatchedStories.forEach(function (matchedStory) {
      var storyName = matchedStory['key'];
      var storyMaterials = matchedStory['value'];
      var allMats = stories[storyName].join('<br> ');

      var tableRow = '<tr>\n' +
        '              <td>' + storyName + '</td>\n' +
        '              <td>' + storyMaterials.length + '</td>\n' +
        '              <td>' + storyMaterials.join(', ') + '</td>\n' +
        '              <td><button type="button" class="btn btn-secondary" data-toggle="tooltip" data-html="true" data-placement="left" title="' + allMats + '">hover</button></td>\n' +
        '            </tr>';

      $('.story-quest-list tbody').append(tableRow);
    });

    $('[data-toggle="tooltip"]').tooltip();
  }

  $(document).ready(function () {
    $('body').on('click', '.btn-add', addMaterial);
    $('body').on('click', '.materials-list .btn-close', deleteMaterial);
    $('body').on('click', '.btn-calculate', calculate);
  });

}(jQuery));
